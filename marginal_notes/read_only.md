# К вопросу о неизменности.
*Андрей Гончаров*  
*дн dd месяц YYYY завершения написания*    

*Лишь в неизменном — бесконечность,*  
*Лишь в постоянном глубина.*  
*И дальше путь, и ближе вечность,*  
*И всё ясней: любовь одна.*  

*Зинаида Гиппиус*


##### Аннотация
В статье рассматривается концепция неизменности состояния. На примере языка программирования C#, показаны способы выражения и достижения неизменности посредствам различных языковых конструкций. Для каждой языковой конструкции C# рассматривается ее результат, в смысле достижения неизменности состояния, и смысловая нагрузка, с точки зрения коммуникотивной функции языка. Предлагается способ обозначения неизменности состояния через выделения из интерфейса класса подможества "только для чтения".    

#### Введение
Для задания контекста дальнейшему изложению, начну с нескольких слов о языках программирования как таковых.  

Любой язык программирования, это прежде всего **язык**. В лингвистике определяют несколько функций языка[<sup>1</sup>](#1), главная из которых, с точки зрения языков программирования, коммуникативная. Но, в отличие от естественных языков, где в большенстве случаев субъекты коммуникации являются сущности одной природы, в случае языков программирования, субъекты могут быть двух типов. К первому типу относится человек, т.е. при использовании языка программирования коммуникация происходит между программистами. Возможно даже что коммуникация происходит между одним и тем же программистом, но в различные моменты времени. Ко второму типу субъектов относится машина, т.е. коммуникация происходит между программистом и машиной. Термин "машина" здесь используется в широком смысле, это может быть как  "железо", так и компиляторы и интерпритаторы.  
Как между программистом и машиной существует принципиальное различие, так и ограничания и свойства языка определяемые этими двумя типами субъектов существенно отличаются. Машина выполняет только то, что написано в программе. Коммуникация человек-машина, накладывает на язык ограничение в виде "формализма", т.е. определения конечного набора ключевых слов и правил построения языковых конструкций. Код должен быть корректным с точки зрения формализма, больше, со стороны машины, не предъявляется ни каких требований к исходному коду.  Но при всей формальности языка программирования, существует довольно много способов записать на нем корректный код.  
Код программы это текст. Текст - это зафиксированная мысль. В отличие от машины, которая игнорирует способ *написания* кода, человек получает дополнительную информацию, дополнительный контекст из того, как код *записан*. Эта дополнительная информация влияет на интерпритацию кода  программистом. Таким образом, выбор способа написания корректного кода, из множества возможных вариантов, делается, по крайней мере должен делаться, исходя из идеи коммуникации человек-человек. Код должен быть понятен, а мысль в нем заключенная, должна иметь минимальное количество возможных интерпритаций читателем. В результате возникает ограничение, правда не на язык, но на способ его использования, в виде стандарта кодирования.   

Так как машина выполняет только то что написано в программе, а программист может интерпритировать код различным образом, то логично, что языки программирования могут содеражть конструкции обеспечивающие концепции, которые, фактически, защищают программу от неверной интерпритации, и, как следствие, неверного использования кода другим программистом. К таким концепциям можно отнести, например, квалификаторы доступа и уровни видимости. К ним же относится и концепцию неизменяемости состояния.

#### 1. Незименяемость состояния.
В обычной жизни мы больше имеем дело с изменяющимеся сущностями чем с константами. В языках программирования дело обстоит похожим образом: переменная - это более распространненая концепция чем константа. Если рассматривать неизменяемость состояния, как неизменяемость совокупности данных в программе, то необходимо рассмотреть, как эти данные хранятся. Простое определенеие для переменных звучит так: переменная - это именованная область памяти[<sup>2</sup>](#2). Из этого определения видно, что проще обеспечить существование переменных, ибо память в машине, чаще всего, предназначина для многократного переиспользвания - перезаписи. Чтобы запретить запись в какую-либо часть памяти, необходимы дополнительные усилия. Существуют языки программирования где нет констант вообще, например, до выхода ECMAScript 2015 в JS не было простого способа создать константу[<sup>3</sup>](#3). Есть языки, где нет переменных, например, для большенства функциональных языков[<sup>4</sup>](#4)[<sup>5</sup>](#5), концепция переменной искусственна. Но, даже если в языке присутствует присутствуют конструкции для создания констант, это не всегда константы в полном соответствии этому слову, простейший пример тот же const в JS[<sup>6</sup>](#6).

[//]: # (
Что это?
Переменная и константа, почему константа это сложнее чем переменная. 
Существование языков без переменных и без констант. 
Возможные интерпритации неизменности. 
Проблемы отсутствия неизменности. 
Выражение неизменяемости в языке, для машины, для программиста. 
Формализм и конвенция. 
Плюсы и минусы незименности.)

#### 2. Языковые конструкции C# для выражения постоянства.
[//]: # (
литералы
const
readonly static/nonstatic
struct
readonly struct
ref readonly - оптимизация по памяти, для структур, при возврате.
in param - оптимизация по памяти, для структур, при передаче параметра.
Array и ошибки с ним
IReadOnlyCollection<T>
Шаблон ValueObject)


#### 3. Метод выделения ReadOnly подможества в API класс
[//]: # (
const в объевлении методов в С++, 
const в объявлении переменных,
конструкция const T& - как оптимизация по памяти, с выражением неизменности.)

#### Заключение
[//]: # (О важности и значимости конструкция указывающих на постоянство.)

##### Список литературы
<a class='anchor' id='1'>1</a>. Мартине А. Основы обшей лингвистики \[в:\] Новое в лингвистике. – М., 1963  
<a class='anchor' id='2'>2</a><a href="https://ru.wikipedia.org/wiki/%D0%9F%D0%B5%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%BD%D0%B0%D1%8F_(%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5)">(Wiki) Переменная (программирование)</a>
<a class='anchor' id='3'>3</a><a href="https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference/Statements/const">MDN web docs, const</a>
<a>4</a><a href="https://ru.wikipedia.org/wiki/%D0%A4%D1%83%D0%BD%D0%BA%D1%86%D0%B8%D0%BE%D0%BD%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B5_%D0%BF%D1%80%D0%BE%D0%B3%D1%80%D0%B0%D0%BC%D0%BC%D0%B8%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5">Wiki Функциона́льное программи́рование</a>
<a>5</a><a href="https://ru.wikibooks.org/wiki/Haskell/VariablesAndFunctions#%D0%9F%D0%B5%D1%80%D0%B5%D0%BC%D0%B5%D0%BD%D0%BD%D1%8B%D0%B5_%D0%B2_%D0%B8%D0%BC%D0%BF%D0%B5%D1%80%D0%B0%D1%82%D0%B8%D0%B2%D0%BD%D1%8B%D1%85_%D1%8F%D0%B7%D1%8B%D0%BA%D0%B0%D1%85">Haskell/VariablesAndFunctions / Переменные в императивных языках.</a>

<a class='anchor' id='6'>6</a><a href="https://medium.com/@frontman/const-%D0%B2-js-%D0%B4%D0%B5%D0%BB%D0%B0%D0%B5%D1%82-%D1%81%D0%B2%D0%BE%D1%8E-%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D1%83-%D0%BF%D1%80%D0%B0%D0%B2%D0%B8%D0%BB%D1%8C%D0%BD%D0%BE-b346353d9cce">Александр Майоров CONST в JS делает свою работу правильно! Alexander Mayorov — Pro WEB IT</a>
